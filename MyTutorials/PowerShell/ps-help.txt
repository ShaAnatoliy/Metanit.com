
PowerShell[.exe] [-PSConsoleFile <файл> | -Version <версия>]
    [-NoLogo] [-NoExit] [-Sta] [-Mta] [-NoProfile] [-NonInteractive]
    [-InputFormat {Text | XML}] [-OutputFormat {Text | XML}]
    [-WindowStyle <стиль>] [-EncodedCommand <Base64EncodedCommand>]
    [-ConfigurationName <строка>]
    [-File <путь_к_файлу> <аргументы>] [-ExecutionPolicy <политика_выполнения>]
    [-Command { - | <блок_сценария> [-args <массив_аргументов>]
                  | <строка> [<параметры_команды>] } ]

PowerShell[.exe] -Help | -? | /?

-PSConsoleFile
    Загружает указанный файл консоли Windows PowerShell. Для создания файла
    консоли используйте командлет Export-Console в Windows PowerShell.

-Version
    Запускает указанную версию Windows PowerShell. 
    Введите с этим параметром номер версии, например: "-version 2.0".

-NoLogo
    Скрывает уведомление об авторских правах при запуске.

-NoExit
    Предотвращает завершение работы после выполнения команд запуска.

-Sta
    Запускает оболочку с использованием однопотокового подразделения.
    Однопотоковое подразделение используется по умолчанию.

-Mta
    Запускает оболочку с использованием многопотокового подразделения.

-NoProfile
    Предотвращает загрузку профиля Windows PowerShell.

-NonInteractive
    Предотвращает вывод интерактивных запросов для пользователя.

-InputFormat
    Определяет формат данных, отправляемых в Windows PowerShell. Допустимые
    значения: "Text" (текстовые строки) или "XML" (сериализованный формат CLIXML).

-OutputFormat
    Определяет формат выходных данных Windows PowerShell. Допустимые
    значения: "Text" (текстовые строки) или "XML" (сериализованный формат CLIXML).

-WindowStyle
    Задает стиль окна: Normal, Minimized, Maximized или Hidden.

-EncodedCommand
    Принимает строковую версию команды в кодировке base 64. Используйте этот 
    параметр для отправки в Windows PowerShell команд с использованием сложных 
    кавычек или фигурных скобок.

-ConfigurationName
    Определяет конечную точку конфигурации, в которой запущена Windows PowerShell.
    Это может быть любая конечная точка, зарегистрированная на локальной машине, включая
    удаленные конечные точки Windows PowerShell по умолчанию или пользовательские конечные точки, имеющие
    специальные возможности роли пользователя.
    
-File
    Запускает указанный сценарий в локальной области ("с точкой"), чтобы 
    создаваемые сценарием функции и переменные были доступны 
    в текущем сеансе. Введите путь к файлу сценария и любые параметры. 
    Параметр File должен быть последним в команде, поскольку все символы, 
    введенные после параметра File, интерпретируются 
    как путь к файлу сценария и следующие за ним параметры сценария.

-ExecutionPolicy
    Задает политику выполнения по умолчанию для текущего сеанса и 
    сохраняет ее в переменной среды $env:PSExecutionPolicyPreference. 
    Этот параметр не изменяет политику выполнения Windows PowerShell, 
    заданную в реестре.

-Command
    Выполняет указанные команды (и любые параметры) как введенные
    в командной строке Windows PowerShell, а затем завершает работу, 
    если не задан параметр NoExit. Значением параметра Command
    может быть "-", строка или блок сценария.

    Если Command имеет значение "-", текст команды считывается из стандартного
    ввода.

    Если значением Command является блок сценария, он должен быть заключен
    в фигурные скобки ({}). Вы можете указать блок сценария только при
    использовании PowerShell.exe в Windows PowerShell. Результаты блока сценария возвращаются родительской оболочке как
    десериализованные объекты XML, а не как активные объекты.

    Если значением Command является строка, параметр Command должен быть
    последним в команде, поскольку любой знак, введенный после него, 
    интерпретируется как аргумент команды.

    При написании строки команды Windows PowerShell используйте следующий формат:
	"& {<команда>}", где
    кавычки отделяют строку, а оператор вызова (&)
    запускает выполнение команды.

-Help, -?, /?
    Отображает это сообщение. При вводе команды PowerShell.exe в Windows
    PowerShell ставьте перед параметрами дефис (-), а не косую черту (/).
    В Cmd.exe вы можете использовать либо дефис, либо косую черту.

ПРИМЕРЫ:
    PowerShell -PSConsoleFile SqlSnapIn.Psc1
    PowerShell -version 2.0 -NoLogo -InputFormat text -OutputFormat XML
    PowerShell -ConfigurationName AdminRoles
    PowerShell -Command {Get-EventLog -LogName security}
    PowerShell -Command "& {Get-EventLog -LogName security}"

    # Использование параметра -EncodedCommand:
    $command = 'dir "c:\program files" '
    $bytes = [System.Text.Encoding]::Unicode.GetBytes($command)
    $encodedCommand = [Convert]::ToBase64String($bytes)
    powershell.exe -encodedCommand $encodedCommand
