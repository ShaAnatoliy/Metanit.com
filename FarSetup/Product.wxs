<?xml version="1.0" encoding="UTF-8"?>

<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
	<?define ProductName="InstForFar" ?>
	<?define ProductVersion="1.0.0.0" ?>
	<?define ProductCode="79e9cf0d-37a6-402f-a46e-53e88c406a33"?>
	<?define UpgradeCode="91feb7bf-6f67-4a3f-b0b9-dc4403e8e16c"?>
	<?define Manufacturer="AnatolyiiSh"?>

	<Product Id="$(var.ProductCode)" Name="$(var.ProductName)" Language="1049" 
           Version="$(var.ProductVersion)" 
           Manufacturer="$(var.Manufacturer)" 
           UpgradeCode="$(var.UpgradeCode)">
		<Package InstallerVersion="200" Compressed="yes" InstallScope="perMachine" />

		<Media Id="1" Cabinet="media1.cab" EmbedCab="yes" />

		<MajorUpgrade DowngradeErrorMessage="A newer version of [ProductName] is already installed." />

		<Feature Id="ProductFeature" Title="$(var.ProductName)" Level="1">
			<ComponentGroupRef Id="ProductComponents" />
			<ComponentRef Id="ApplicationShortcutFar" />
		</Feature>

		<Property Id="WIXUI_INSTALLDIR" Value="INSTALLLOCATION" />
		<WixVariable Id="WixUILicenseRtf" Overridable="yes" Value="License.rtf"/>
		<UIRef Id="WixUI_InstallDir"/>

	</Product>

	<Fragment>
		<Directory Id="TARGETDIR" Name="SourceDir">
			<Directory Id="ProgramFilesFolder">
				<Directory Id="INSTALLFOLDER" Name="$(var.ProductName)" />
			</Directory>

			<Directory Id="ProgramMenuFolder">
				<Directory Id="ApplicationProgramsFolder" Name="$(var.ProductName)">
					<Component Id="ApplicationShortcutFar" Guid="4CEBD68F-E933-47f9-B02C-A4FC69FDB551">
						<Shortcut Id="ShortcutFar"
                 Name="Far"
                 Description="$(var.ProductName)"
                 Target="[INSTALLLOCATION]Far.exe"
                 WorkingDirectory="INSTALLLOCATION"/>
						<RemoveFolder Id="ApplicationProgramsFolder" On="uninstall"/>
						<RegistryValue Root="HKCU" Key="Software\$(var.Manufacturer)\$(var.ProductName)" Name="installed" Type="integer" Value="1" KeyPath="yes"/>
					</Component>
				</Directory>
			</Directory>

		</Directory>
	</Fragment>

	<Fragment>
		<ComponentGroup Id="ProductComponents" Directory="INSTALLFOLDER">
			<Component Id="ProductComponent">
				<File Id='Far_exe' DiskId='1' Source='C:\FarManX64\Far.exe'/>
			</Component> 
		</ComponentGroup>

	</Fragment>

</Wix>
